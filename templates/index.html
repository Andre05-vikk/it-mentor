<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IT-Mentor</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <!-- Navigation bar with IT-Mentor logo and buttons -->
    <nav class="navbar">
        <div class="navbar-logo">IT-Mentor</div>
        <div class="navbar-links">
            <button class="nav-btn">About</button>
            <button class="nav-btn">Explore</button>
        </div>
        <div class="navbar-auth">
            <button class="auth-btn">Sign Up</button>
            <button class="auth-btn">Login</button>
        </div>
    </nav>

    <!-- Main content with Add Question button -->
    <div class="content">
        <button id="addQuestionBtn">Add question</button>
    </div>

    <!-- Modal for adding question -->
    <div id="questionModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="textarea-container">
                <textarea id="questionText" placeholder="Enter question here" maxlength="1000"></textarea>
                <div class="character-limit-box">
                    <span id="characterLimit">The maximum text length is 1000 characters</span>
                </div>
                <button id="sendBtn" disabled>Send</button>
            </div>
        </div>
    </div>

    <script>
        const addQuestionBtn = document.getElementById('addQuestionBtn');
        const questionModal = document.getElementById('questionModal');
        const questionText = document.getElementById('questionText');
        const sendBtn = document.getElementById('sendBtn');
        const characterLimit = document.getElementById('characterLimit');

        // Open modal on "Add question" button click
        addQuestionBtn.addEventListener('click', () => {
            questionModal.style.display = 'flex';
        });

        // Close modal when clicking outside of modal content
        questionModal.addEventListener('click', (e) => {
            if (e.target === questionModal) {
                questionModal.style.display = 'none';
            }
        });

        // Update send button state and character limit warning
        questionText.addEventListener('input', () => {
            const textLength = questionText.value.length;
            sendBtn.disabled = textLength === 0 || textLength > 1000;
            characterLimit.style.color = textLength > 1000 ? 'red' : 'gray';
        });

        // Send question to server
        sendBtn.addEventListener('click', () => {
            const question = questionText.value;

            fetch('/submit_question', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ question }),
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert(data.message);
                    questionModal.style.display = 'none';
                    questionText.value = '';
                } else {
                    alert(data.message);
                }
            })
            .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>
